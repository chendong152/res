<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
    <meta http-equiv="Pragma" content="no-cache"/>
    <meta http-equiv="Expires" content="0"/>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <link href="css/main.css" rel="stylesheet"/>
    <link href="css/swiper3.1.0.min.css" rel="stylesheet"/>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/swiper3.1.0.jquery.min.js"></script>
    <script type="text/javascript" src="js/util.js"></script>
    <script charset="utf-8" src="http://map.qq.com/api/js?v=2.exp&key=ZCZBZ-TSO34-EJ5UK-XWOR6-SV4ZV-RQBDB"></script>
    <script charset="utf-8"
            src="http://map.qq.com/api/js?v=2.exp&key=ZCZBZ-TSO34-EJ5UK-XWOR6-SV4ZV-RQBDB&libraries=drawing,geometry,autocomplete,convertor"></script>
    <script type="text/javascript" src="js/bh.js"></script>
    <script type="text/javascript" src="js/c.js"></script>
    <script type="text/javascript" src="js/b.js"></script>
    <base target="detail"/>
    <title>天下美食</title>
</head>
<body>
<header>
    <div class="holder"></div>
    <span class="city">[]
    </span>

    <div class="citys">
        <span class="ct" data-id="{areaId}">{name}</span>
        <span class="ct" data-id="2">上海</span>
        <span class="ct" data-id="3">深圳</span>
        <span class="ct" data-id="4">广州</span>
    </div>
    <input class="search" placeholder="输入商户名、地点"/>
    <span class="sort">
        <span>离我最近</span>
        <ul>
            <li class="active" data-key="dis">离我最近</li>
            <li data-key="price" data-desc="true">价格最高</li>
            <li data-key="price">价格最低</li>
        </ul>
    </span>
    <script type="text/javascript">
        $(".sort").click(function (e) {
            $(this).toggleClass('show');
            var t = $(e.target);
            if (e.target.tagName == "LI" && !t.hasClass("active")) {
                $(this).find('span').text(t.text()).end().find('>ul>li').removeClass('active');
                $(this).data('key', t.addClass('active').data('key')), sdk.sort(t.data('key'), t.data('desc'));
            }
        });
        $(".city").click(function () {
            $('.citys').toggle(200);
        });
        $(".citys").delegate('.ct', 'click', function () {
            $(".citys").hide();
            if ($('.city').data('id') == $(this).data('id')) return;
            $('.city').data('id', myCityId = $(this).data('id')).text('[' + $(this).text().replace(/市$/, '') + ']'), fire('cityChange', $(this).data('id'));
            $(".search").val('');
        });
        $(".search").keydown(function (e) {
            if (e.which == 13) {
                sdk[s1.activeIndex == 0 ? 'search' : 'searchNews']($(this).blur().val()), changeState('s2'), $(".news .list").scrollTop(0);
            }
        })
    </script>
</header>
<div class="main">
    <div class="header-holder"></div>
    <div id="s1" class="swiper-container">
        <div class="swiper-pagination" style="top: 0; bottom: auto;"></div>
        <div class="swiper-wrapper" style=" top: 4%; height: 96%;">
            <div class="swiper-slide rets">
                <ul class="list">
                    <li class="item" href="{contentURL}" style="position: relative;">
                        <!--a href="{contentURL}" target="_top" style="
    display: block;
    opacity: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    position: absolute;
"></a-->
                        <img class="thumb" src="{titlePic}"/>

                        <div class="mask one"></div>
                        <div class="mask two"></div>
                        <div class="distance fr pt">{distance}km</div>
                        <div class="title pr pt">{title}</div>
                        <div class="intro pr">{intro}</div>
                        <div class="price fr">￥<span class="digit">{spend}</span>/人</div>
                    </li>
                </ul>
                <div id="mapc" class="map s2">
                    <div class="to-my-loc" onclick="getLocation()"></div>
                    <div class="small btn bg" onclick="changeState($('#mapc').hasClass('min')? '':'s2')">
                        缩小
                    </div>
                    <div class="my-loc mask">
                        <img src="img/map.png"/>
                        <span class="arrow fr" onclick="changeState('min')">&gt;</span>
                        <a class="fr btn bg" onclick="changeState('')">地图</a>
                        <script>
                            function changeState(s) {
                                $('#mapc >.small').text(s == 'min' ? '地图' : '缩小')
                                $("#mapc").removeClass("s2").removeClass("min").addClass(s);
                            }
                        </script>
                    </div>
                    <div id="map-container" class="wrapper"></div>
                    <label class="d my-addr mask">当前：不能定位</label>
                    <script type="text/javascript">
                        $("#mapc .wrapper").bind("touchstart", function (e) {
                            e.stopPropagation();
                            return false;
                        });
                        map = new qq.maps.Map(document.getElementById("map-container"), {
                            center: new qq.maps.LatLng(39.914850, 116.403765),
                            zoom: 13, zoomControl: false, mapTypeControl: false, scaleControl: false, panControl: false,
                            draggable: true, scrollwheel: true, disableDoubleClickZoom: false,
                        });
                        $(function () {
                            $(".rets .list").delegate('li', 'click', function () {
                                ($("#resAssis").length > 0 ? $("#resAssis") : $("<a id='resAssis' target='_top' style='display:none;'>").appendTo($(document.body)))
                                        .attr("href", $(this).attr("href"))[0].click();
                            })
                            $('.swiper-container').height($(window).height() - $('header').height());
                        });
                    </script>
                </div>

            </div>
            <div class="swiper-slide news">
                <ul class="list">
                    <li>
                        <a href="{uRL}" data-id="{id}">
                            <img class="thumb" src="img/demo.png"/>

                            <span class="title">{title}</span>
                            <span class="time">{creatDate}</span>
                            <span class="count">{readTimes}</span>

                            <div class="clear"></div>
                        </a>
                    </li>
                </ul>
                <style>
                    .news a, .news a:active, .news a:visited { color: black; }
                    .news .list { list-style: none; margin: 0; padding: 0; width: 100%; overflow-y: auto; height: 100%; }
                    .news .list li { background: url("img/bg.png") center bottom no-repeat; background-size: 100% auto; padding: 1em 0; }
                    .news .list li:first-child { padding-top: 0; }
                    .news .list li .thumb { width: 100%; }
                    .news .list li .title { margin-left: 1em; width: 65%; float: left; }
                    .news .list li .time { margin-right: 1em; float: right; }
                    .news .list li .count { margin-right: 1em; padding-left: 1.5em; background: url("img/m.png") left center no-repeat; -webkit-background-size: 1.3em; background-size: 1.3em; float: right; }
                    .swiper-pagination-bullet { width: 6px; height: 6px; border: 2px solid red; background-color: white; }
                    .swiper-pagination-bullet-active { top: -1px;
                        background-color: red; border-color: white; width: 4px; height: 4px; position: relative;
                    }
                    .swiper-pagination-bullet-active::after { content: " "; width: 10px; height: 10px; background: red; border-radius: 100%;
                        position: absolute; left: -3px; top: -3px; z-index: -1; }
                </style>
            </div>
        </div>
        <script type="text/javascript">
            s1 = new Swiper('#s1', {
                direction: 'horizontal', loop: false, pagination: '.swiper-pagination',
                onSlideChangeEnd: function (swiper) {
                    var arr = ['输入商户名、地点', '输入关键字搜索'];
                    swiper['kw' + swiper.previousIndex] = $('.search').val();
                    $('.search').attr('placeholder', arr[swiper.activeIndex]).val(swiper['kw' + swiper.activeIndex] || '');
                }
            });
        </script>
    </div>
</div>

<div class="ic">
    <iframe id="detail" name="detail">
    </iframe>
    <div class="frm-tool">
        <a class="btn">返回</a>
    </div>
    <script type="text/javascript">
        $('.frm-tool').click(function () {
            //$("#detail").removeClass('show');
            // $('.frm-tool').hide();
            $(".ic").hide();
        });
        $("#detail").load(function () {
            // $('.frm-tool').show();
            // $(this).addClass('show').show(100);
            $(".ic").toggle();
        });
    </script>
</div>
</body>
</html>